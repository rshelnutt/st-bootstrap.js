<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>st-bootstrap.js | Generate Instagram Access Token</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <meta name="description" content="Generate an Instagram access token using the credentials of the desired account.">
        <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
        <!-- // jQuery -->
        <script src="//code.jquery.com/jquery-3.3.1.min.js"></script>

        <script>

            function getUserList(setVal) {
                // https://www.instagram.com/web/search/topsearch/?context=blended&query=%22webdevrob%22&rank_token=0.3953592318270893
                $.ajax({
                    type: "GET",
                    dataType: "jsonp",
                    cache: false,
                    // url: "https://www.instagram.com/web/search/topsearch/?context=blended&query=%22" + setVal + "%22&rank_token=0.3953592318270893",
                    url: "https://www.instagram.com/web/search/topsearch/?context=blended&query=%22webdevrob%22&rank_token=0.3953592318270893",
                    success: function(data) {
                        console.log(data)
                        var userList = document.body.appendChild(document.createElement('div'));
                        userList.id = 'userList';
                        for(var i=0;i<20;i++) {
                            var userItem = userList.appendChild(document.createElement('li'));
                                userItem.className = 'user_item';
                            var instauser = data.users.user[i];
                            userItem.innerHTML = '<a href="' + instauser.username + '" target="_blank"><h3>'+ instauser.username +'</h3><img src="' + instauser.profile_pic_url + '"></a>';
                        }
                    },
                    error: function(xhr, ajaxOptions, thrownError) {
                        console.log(xhr.status, thrownError);
                    }
                });
            }

            function init() {
                function getUrlVars() {
                    var vars = {};
                    var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
                        vars[key] = value;
                    });
                    return vars;
                }

                function getUrlParam(parameter, defaultvalue){
                    var urlparameter = defaultvalue;
                    if(window.location.href.indexOf(parameter) > -1){
                        urlparameter = getUrlVars()[parameter];
                    }
                    return urlparameter;
                }

                // var e = getUrlParam('code','Empty');
                var e = '349921056.5182bc5.ecdda7788ead4b0cb35079da006c5c96';

                $.ajax({
                    type: "GET",
                    dataType: "jsonp",
                    cache: false,
                    // url: "https://api.instagram.com/v1/users/[USER_ID]/media/recent/?client_id=[CLIENT_ID]",
                    url: "https://api.instagram.com/v1/users/self/?access_token=" + e,
                    success: function(data) {
                        // set the space you'll be working with in your index.html file
                        var feed = document.getElementById('instagram-feed');
                        // setting a count variable to limit the number of photos
                        // you could also use the count parameter in the URL
                        // var count = 0;
                        // for(var mug=0;mug<10;mug++) {
                            // create <li> element and append to the #instagram-feed
                            // then for each object element, add the appropriate content
                            // var image = feed.appendChild(document.createElement('li'));
                            var success = document.body.appendChild(document.createElement('div'));
                            // image.className = 'insta';
                            success.id = 'success';
                            // var insta = data.data[mug];
                            var insta = data.data;
                            // image.innerHTML = '<a href="' + insta.link + '" target="_blank"><img src="' + insta.images.thumbnail.url + '"></a>';
                            success.innerHTML = '<h1>You\'ve got the Access Token</h1>\n' +
                                '<div>Congratulations, @' + insta.username + '! You\'ve just got your own Instagram Access Token.</div>\n' +
                                '<div id="instaID"><input type="text" value="' + insta.id + '" readonly=""></div>\n' +
                                '<div id="instaToken"><input type="text" value="" readonly=""></div>' +
                                '</div>';
                        // }
                    },
                    error: function(xhr, ajaxOptions, thrownError) {
                        console.log(xhr.status, thrownError);
                    }
                });
            }
            // window.onLoad = init();
        </script>
    </head>

    <body>
        <input id="user-search" title="User Search" type="text" />
        <a href="javascript:void(0)" class="get-user">Find User 2</a>

        <form class="client-form">
            <input type="text" name="stgenerator_client_id" placeholder="Client ID" value="5182bc5223764de78ea5e6d4081d41ca">
            <input type="hidden" name="stgenerator_client_secret" placeholder="Client Secret" value="db0d09c1868b4d0eb27f631074469012">
        </form>
        <div class="auth">
            <a href="javascript:void(0)" class="auth-button">Get Instagram Access Token</a>
        </div>
        <div id="instagram-feed"></div>
    </body>

    <script>
        $(".auth-button").click(function() {
            var e = $('[name="stgenerator_client_id"]').val().trim(),
                n = $('[name="stgenerator_client_secret"]').val().trim();
                // document.cookie = "stgenerator_client_id=" + e,
                // document.cookie = "stgenerator_client_secret=" + n;
            /*var r = $.param({
                client_id: e,
                redirect_uri: "https://devtools.speartek.com/generate-instagram-access-token/",
                response_type: "code"
            });
            document.location.href = "https://api.instagram.com/oauth/authorize/?" + r*/
            init()
        });

        $(".get-user").click(function() {
            var x = $('#user-search').val().trim();
            getUserList(x);
        });

        var e = $(".token input");

        e.on("focus click", function() {
            e.select()
        });
    </script>
</html>

<!--https://api.instagram.com/oauth/authorize/?client_id=CLIENT-ID&redirect_uri=REDIRECT-URI&response_type=code-->